(window.webpackJsonp=window.webpackJsonp||[]).push([[42,67],{iQVT:function(e,a,t){"use strict";t.r(a);var n=t("LvDl"),r=t.n(n),o=t("ke3Z"),s={head:{title:function(){return{inner:this.form.name||"Loading..."}}},components:{"markdown-field":t("qt+H").default},data:function(){return{id:null,ready:!1,placeholders:{},form:new o.a({name:"",handle:"",markdown:"",status:"1"},!0)}},methods:{isArray:function(e){return r.a.isArray(e)},addPlaceholder:function(e,a){var t=this.$refs.markdown.codemirror.getDoc();t.getCursor();a?t.replaceSelection("{{ $".concat(a,"->").concat(e," }}"),t.getSelection()):t.replaceSelection("{{ $".concat(e," }}"),t.getSelection())},updateMarkdown:function(e){this.form.markdown=e},submit:function(){var e=this;this.form.patch("/api/mailables/"+this.id).then((function(a){toast("Mailable successfully updated","success"),e.$router.push("/mailables")})).catch((function(e){toast(e.response.data.message,"failed")}))},placeholderOptions:function(e){var a=[];return r.a.each(e,(function(e){a.push({label:e,value:e})})),a}},beforeRouteEnter:function(e,a,t){axios.all([axios.get("/api/mailables/".concat(e.params.mailable))]).then(axios.spread((function(e){t((function(a){a.id=e.data.data.id,a.placeholders=e.data.data.placeholders,a.ready=!0,a.form.name=e.data.data.name,a.form.handle=e.data.data.handle,a.form.markdown=e.data.data.markdown,a.$emit("updateHead"),a.$nextTick((function(){a.form.resetChangeListener()}))}))}))).catch((function(e){t("/mailables"),toast("The requested mailable could not be found","warning")}))}},l=t("KHd+"),i=Object(l.a)(s,(function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("form-container",{scopedSlots:e._u([{key:"sidebar",fn:function(){return[t("div",{staticClass:"card"},[t("div",{staticClass:"card__body"},[t("p-slug",{attrs:{name:"handle",label:"Handle",monospaced:"",autocomplete:"off",required:"",watch:e.form.name,"has-error":e.form.errors.has("handle"),"error-message":e.form.errors.get("handle")},model:{value:e.form.handle,callback:function(a){e.$set(e.form,"handle",a)},expression:"form.handle"}}),e._v(" "),t("p-toggle",{attrs:{name:"status",label:"Status","true-value":1,"false-value":0},model:{value:e.form.status,callback:function(a){e.$set(e.form,"status",a)},expression:"form.status"}})],1)]),e._v(" "),t("div",{staticClass:"card"},[t("div",{staticClass:"card__body"},[t("p",{staticClass:"text-sm"},[e._v("Below you will find a variety of values you may reference within your template.")]),e._v(" "),e._l(e.placeholders,(function(a,n){return t("div",{key:n},[e.isArray(a)?e._e():t("p-button",{staticClass:"w-full mb-3 text-xs font-mono",on:{click:function(t){return e.addPlaceholder(a)}}},[e._v("$"+e._s(a))]),e._v(" "),t("p-dropdown",{attrs:{id:"values"},scopedSlots:e._u([{key:"menu",fn:function(){return e._l(a,(function(a,r){return t("p-dropdown-link",{key:r,staticClass:"text-xs",on:{click:function(t){return e.addPlaceholder(a,n)}}},[e._v("\n                                    "+e._s(a)+"\n                            ")])}))},proxy:!0}],null,!0)},[e._v("\n                        $"+e._s(n)+"\n\n                        ")])],1)}))],2)])]},proxy:!0}])},[t("portal",{attrs:{to:"title"}},[t("app-title",{attrs:{icon:"mail-bulk"}},[e._v("Edit Mailable")])],1),e._v(" "),t("portal",{attrs:{to:"actions"}},[t("div",{staticClass:"buttons"},[t("router-link",{staticClass:"button",attrs:{to:{name:"mailables"}}},[e._v("Go Back")]),e._v(" "),t("button",{staticClass:"button button--primary",class:{"button--disabled":!e.form.hasChanges},attrs:{type:"submit",disabled:!e.form.hasChanges},on:{click:function(a){return a.preventDefault(),e.submit(a)}}},[e._v("Save")])],1)]),e._v(" "),t("div",{staticClass:"card"},[t("div",{staticClass:"card__body"},[t("p-title",{attrs:{name:"name",autocomplete:"off",autofocus:"",required:"","has-error":e.form.errors.has("name"),"error-message":e.form.errors.get("name")},model:{value:e.form.name,callback:function(a){e.$set(e.form,"name",a)},expression:"form.name"}}),e._v(" "),e.ready?t("markdown-field",{ref:"markdown",attrs:{field:{name:"Content",handle:"markdown"},value:e.form.markdown},on:{input:e.updateMarkdown}}):e._e()],1)])],1)}),[],!1,null,null,null);a.default=i.exports},"qt+H":function(e,a,t){"use strict";t.r(a);var n=t("VrN/"),r=t.n(n),o=t("DlQD"),s=t.n(o);t("RKCW"),t("mki7"),t("19Vz");var l={name:"markdown-fieldtype",data:function(){return{codemirror:null}},props:{field:{type:Object,required:!0},value:{required:!1,default:""}},computed:{preview:function(){var e=s.a.lexer(this.value||"");return s.a.parser(e)}},mounted:function(){var e=this;this.codemirror=r.a.fromTextArea(document.getElementById(this.field.handle),{theme:"fusion",mode:{name:"gfm",highlightFormatting:!0,fencedCodeBlockHighlighting:!0},lineWrapping:!0,viewportMargin:1/0,keyMap:"sublime"}),setTimeout((function(){e.codemirror.refresh()}),1),this.codemirror.on("change",(function(a){e.$emit("input",a.getValue())}))}},i=t("KHd+"),d=Object(i.a)(l,(function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("div",{staticClass:"form__group"},[t("label",{staticClass:"form__label",attrs:{for:e.field.handle},domProps:{innerHTML:e._s(e.field.name)}}),e._v(" "),t("p-tabs",[t("p-tab",{attrs:{name:"Markdown"}},[t("textarea",{directives:[{name:"model",rawName:"v-model",value:e.value,expression:"value"}],attrs:{name:e.field.handle,id:e.field.handle,cols:"30",rows:"12",autofocus:""},domProps:{value:e.value},on:{input:function(a){a.target.composing||(e.value=a.target.value)}}})]),e._v(" "),t("p-tab",{attrs:{name:"Preview"}},[t("div",{staticClass:"markdown-body",domProps:{innerHTML:e._s(e.preview)}})])],1)],1)}),[],!1,null,null,null);a.default=d.exports}}]);