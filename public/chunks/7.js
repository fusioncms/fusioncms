(window.webpackJsonp=window.webpackJsonp||[]).push([[7,59],{WjD0:function(t,e){t.exports="object"==typeof self?self.FormData:window.FormData},XWAd:function(t,e,a){"use strict";var n=a("tUSx");a.n(n).a},iQVT:function(t,e,a){"use strict";a.r(e);var n=a("ke3Z"),r={head:{title:function(){return{inner:this.form.name||"Loading..."}}},components:{"markdown-field":a("qt+H").default},data:function(){return{id:null,ready:!1,placeholders:{},form:new n.a({name:"",handle:"",markdown:"",status:"1"},!0)}},methods:{isArray:function(t){return _.isArray(t)},addPlaceholder:function(t,e){var a=this.$refs.markdown.codemirror.getDoc();a.getCursor();e?a.replaceSelection("{{ $".concat(e,"->").concat(t," }}"),a.getSelection()):a.replaceSelection("{{ $".concat(t," }}"),a.getSelection())},updateMarkdown:function(t){this.form.markdown=t},submit:function(){var t=this;this.form.patch("/api/mailables/"+this.id).then((function(e){toast("Mailable successfully updated","success"),t.$router.push("/mailables")})).catch((function(t){toast(t.response.data.message,"failed")}))}},beforeRouteEnter:function(t,e,a){axios.all([axios.get("/api/mailables/".concat(t.params.mailable))]).then(axios.spread((function(t){a((function(e){e.id=t.data.data.id,e.placeholders=t.data.data.placeholders,e.ready=!0,e.form.name=t.data.data.name,e.form.handle=t.data.data.handle,e.form.markdown=t.data.data.markdown,e.form.resetChangeListener(),e.$emit("updateHead")}))}))).catch((function(t){a("/mailables"),toast("The requested mailable could not be found","warning")}))}},o=(a("XWAd"),a("KHd+")),i=Object(o.a)(r,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"row"},[a("portal",{attrs:{to:"title"}},[a("app-title",{attrs:{icon:"mail-bulk"}},[t._v("Edit Mailable")])],1),t._v(" "),a("portal",{attrs:{to:"actions"}},[a("router-link",{staticClass:"button mr-3",attrs:{to:{name:"mailables"}}},[t._v("Go Back")]),t._v(" "),a("button",{staticClass:"button button--primary",attrs:{type:"submit"},on:{click:function(e){return e.preventDefault(),t.submit(e)}}},[t._v("Save Form")])],1),t._v(" "),a("div",{staticClass:"content-container"},[a("form",{on:{submit:function(e){return e.preventDefault(),t.submit(e)},"~input":function(e){return t.form.onFirstChange(e)}}},[a("p-card",[a("div",{staticClass:"row"},[a("div",{staticClass:"col form-content"},[a("div",{staticClass:"row"},[a("div",{staticClass:"col w-full xxl:w-1/2 mb-6"},[a("p-input",{attrs:{name:"name",label:"Name",help:"What this mailable will be called.",autocomplete:"off",autofocus:"",required:"","has-error":t.form.errors.has("name"),"error-message":t.form.errors.get("name")},model:{value:t.form.name,callback:function(e){t.$set(t.form,"name",e)},expression:"form.name"}})],1),t._v(" "),a("div",{staticClass:"col w-full xxl:w-1/2 mb-6"},[a("p-slug",{attrs:{name:"handle",label:"Handle",help:"A developer-friendly variant of the mailable's name.",autocomplete:"off",required:"",delimiter:"_",watch:t.form.name,"has-error":t.form.errors.has("handle"),"error-message":t.form.errors.get("handle")},model:{value:t.form.handle,callback:function(e){t.$set(t.form,"handle",e)},expression:"form.handle"}})],1),t._v(" "),a("div",{staticClass:"col w-full xxl:w-1/2 mb-6"},[t.ready?a("markdown-field",{ref:"markdown",attrs:{field:{name:"Content",handle:"markdown"},value:t.form.markdown},on:{input:t.updateMarkdown}}):t._e()],1)])])])])],1)]),t._v(" "),a("div",{staticClass:"side-container"},[a("p-card",[a("div",{staticClass:"row"},[a("div",{staticClass:"col w-full"},[a("p-select",{attrs:{name:"status",label:"Status",options:[{label:"Enabled",value:"1"},{label:"Disabled",value:"0"}]},model:{value:t.form.status,callback:function(e){t.$set(t.form,"status",e)},expression:"form.status"}})],1)])]),t._v(" "),a("p-card",{staticClass:"mt-5"},[a("div",{staticClass:"row"},[a("div",{staticClass:"col w-full"},[a("label",{staticClass:"form__label"},[t._v("Placeholders")]),t._v(" "),t._l(t.placeholders,(function(e,n){return[t.isArray(e)?[a("p-dropdown",[t._v("\n                                "+t._s(n)+"\n                                "),a("fa-icon",{staticClass:"float-right",attrs:{icon:"caret-down"}}),t._v(" "),a("template",{slot:"options"},t._l(e,(function(e,r){return a("p-dropdown-item",{key:r,on:{click:function(a){return t.addPlaceholder(e,n)}}},[t._v("\n                                            "+t._s(e)+"\n                                    ")])})),1)],2)]:[a("p-button",{staticClass:"font-semibold text-black",attrs:{size:"small"},on:{click:function(a){return t.addPlaceholder(e)}}},[t._v("\n                                    "+t._s(e)+"\n                            ")])]]}))],2)])])],1)],1)}),[],!1,null,null,null);e.default=i.exports},ke3Z:function(t,e,a){"use strict";a("WjD0");function n(t,e){for(var a=0;a<e.length;a++){var n=e[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var r=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.errors={}}var e,a,r;return e=t,(a=[{key:"has",value:function(t){return this.errors.hasOwnProperty(t)}},{key:"any",value:function(){return Object.keys(this.errors).length>0}},{key:"get",value:function(t){if(this.errors[t])return this.errors[t][0]}},{key:"record",value:function(t){this.errors=t.errors}},{key:"clear",value:function(t){t?delete this.errors[t]:this.errors={}}}])&&n(e.prototype,a),r&&n(e,r),t}(),o=a("5fFP");function i(t,e){for(var a=0;a<e.length;a++){var n=e[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}a.d(e,"a",(function(){return s}));var s=function(){function t(e){var a=arguments.length>1&&void 0!==arguments[1]&&arguments[1];!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.errors=new r,this.originalData=e,this.hasChanges=!1,this.preventNavigation=a;var n=this;for(var o in this.__data={},e)this[o]=e[o],n.__data[o]=n[o],function(t){Object.defineProperty(n,t,{get:function(){return n.__data[t]},set:function(e){n.__data[t]=e,n.hasChanges||n.onFirstChange()}})}(o)}var e,a,n;return e=t,(a=[{key:"set",value:function(t,e){this.data[t]=e}},{key:"get",value:function(t){return this.data[t]}},{key:"reset",value:function(){for(var t in this.originalData)this[t]=this.originalData[t];this.errors.clear()}},{key:"data",value:function(){var t={};for(var e in this.originalData)t[e]=this[e];return t}},{key:"post",value:function(t){return this.submit("post",t)}},{key:"patch",value:function(t){return this.submit("patch",t)}},{key:"put",value:function(t){return this.submit("put",t)}},{key:"delete",value:function(t){return this.submit("delete",t)}},{key:"submit",value:function(t,e){var a=this;return new Promise((function(n,r){axios[t](e,a.data()).then((function(t){a.onSuccess(t.data),o.a.commit("form/setPreventNavigation",!1),n(t.data)})).catch((function(t){a.onFailure(t.response.data),r(t.response.data)}))}))}},{key:"onSuccess",value:function(t){}},{key:"onFailure",value:function(t){this.errors.record(t)}},{key:"onFirstChange",value:function(t){this.hasChanges=!0,this.preventNavigation&&o.a.commit("form/setPreventNavigation",!0)}},{key:"resetChangeListener",value:function(t){this.hasChanges=!1,this.preventNavigation&&o.a.commit("form/setPreventNavigation",!1)}}])&&i(e.prototype,a),n&&i(e,n),t}()},nMOs:function(t,e,a){(t.exports=a("I1BE")(!1)).push([t.i,".button,\n.dropdown__button {\n  width: 50%;\n  padding: 0.5rem;\n  margin-bottom: 0.5rem\n}\n.dropdown__options {\n  width: 100%\n}\n",""])},"qt+H":function(t,e,a){"use strict";a.r(e);var n=a("VrN/"),r=a.n(n);a("RKCW"),a("mki7"),a("19Vz");var o={name:"markdown-fieldtype",data:function(){return{codemirror:null}},props:{field:{type:Object,required:!0},value:{required:!1,default:""}},mounted:function(){var t=this;this.codemirror=r.a.fromTextArea(document.getElementById(this.field.handle),{theme:"fusion",mode:{name:"gfm",highlightFormatting:!0,fencedCodeBlockHighlighting:!0},lineWrapping:!0,viewportMargin:1/0,keyMap:"sublime"}),this.codemirror.on("change",(function(e){t.$emit("input",e.getValue())}))}},i=a("KHd+"),s=Object(i.a)(o,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"form__group"},[a("label",{staticClass:"form__label",attrs:{for:t.field.handle},domProps:{innerHTML:t._s(t.field.name)}}),t._v(" "),a("textarea",{directives:[{name:"model",rawName:"v-model",value:t.value,expression:"value"}],attrs:{name:t.field.handle,id:t.field.handle,cols:"30",rows:"10"},domProps:{value:t.value},on:{input:function(e){e.target.composing||(t.value=e.target.value)}}})])}),[],!1,null,null,null);e.default=s.exports},tUSx:function(t,e,a){var n=a("nMOs");"string"==typeof n&&(n=[[t.i,n,""]]);var r={hmr:!0,transform:void 0,insertInto:void 0};a("aET+")(n,r);n.locals&&(t.exports=n.locals)}}]);